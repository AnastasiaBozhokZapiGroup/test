<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test</title>
</head>
<body>
    <h1>Current Query Parameters</h1>
    <pre id="params">Loading...</pre>

    <script>
        function redirect(queryString) {
            const urlParams = new URLSearchParams(queryString);
            const antMonitorUrl = urlParams.get('state');
            
            if (!antMonitorUrl) {
                document.getElementById('params').textContent = "Redirection URL is not found";
                return;
            }

            const paramsObj = {};
            urlParams.forEach((value, key) => {
                paramsObj[key] = value;
            });
            document.getElementById('params').textContent = 'Will be redirecting to ' + antMonitorUrl + 
                ' in 5 seconds! \nParams are \n' + JSON.stringify(paramsObj, null, 2);

            setTimeout(function() {		  
                urlParams.delete('state');
                const redirectUrl = `${decodeURIComponent(antMonitorUrl)}?${urlParams.toString()}`;
                window.location.href = redirectUrl
            }, 5000);
        }

        redirect(window.location.search);
    </script>
</body>
</html>

